{% import "form/macro/form.twig" as dform %}
<script src="/js/ckeditor/ckeditor.js"></script>
<h1 class="simple-form-h1">{% if data.id %}修改{% else %}新建{% endif %}{{ form.title }}</h1>
<form action="/form/edit" method="post" enctype="multipart/form-data" class="ui form segment">
    <input type="hidden" name="id" value="{{ data.id }}">
    <input type="hidden" name="structure" value="{{ form.name }}">
    {% for name, field in form.fields %}
        <div class="field">
            <label>{{ field.label }}</label>
            {% if field.type == 'text' %}
                <div class="ui left labeled icon input">{{ dform.text(form, name) }}</div>
            {% elseif field.type == 'textarea' %}
                {{ dform.textarea(form, name) }}
            {% elseif field.type == 'html' %}
                {{ dform.html(form, name) }}
            {% elseif field.type == 'image' %}
                <div class="ui left labeled icon input">{{ dform.image(form, name) }}</div>
            {% endif %}
        </div>
    {% endfor %}
    {% for name, rel in form.relations %}
        <div class="field">
            <label>{{ rel.label }}</label>
            {% if rel.type == 'm2o' %}
                {% if rel.display == 'select' %}
                    <div class="ui selection dropdown">
                        <input type="hidden" name="{{ name }}">

                        <div class="text">请选择</div>
                        <i class="dropdown icon"></i>

                        <div class="menu">
                            {% for item in d_content(name) %}
                                <div class="item" data-value="{{ item.id }}">{{ item.title }}</div>
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}
            {% elseif rel.type == 'm2m' %}
                {% if rel.display == 'checkboxes' %}
                    {#<div>{{ rel.label }}：{{ dform.checkboxes(form, name, d_content(name)) }}</div>#}
                    {% for data in d_content(name) %}
                        <div class="ui slider checkbox">
                            {{ dform.checkbox(form, name, data) }}
                            <label for="form_{{ form.name }}_{{ name }}_{{ data.id }}">{{ data.name }}</label>
                        </div>
                    {% endfor %}
                {% endif %}
            {% endif %}
        </div>
    {% endfor %}
    <button class="ui blue submit button">确定</button>
</form>
<script>
    $('.ui.radio.checkbox').checkbox();
</script>